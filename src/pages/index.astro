---
import Layout from '../layouts/Layout.astro';
import GameOptions from '../components/GameOptions';
---

<Layout title="控射挑战 - 刺激成人小游戏">
  <main class="min-h-screen bg-gradient-to-b from-black to-purple-900 flex flex-col items-center justify-center p-6 sm:p-4">
    <!-- 欢迎提示和引导动画，包含渐变文字和消失效果 -->
    <div id="welcomePrompt" class="mb-8 text-center sm:mb-6 animate-pulse">
      <h1 class="text-5xl font-bold mb-4 sm:text-3xl bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">欢迎来到控射挑战</h1>
      <p class="text-white text-xl sm:text-base">选择你的挑战模式，开始刺激的游戏！</p>
    </div>
    <!-- 游戏选项组件容器 -->
    <div class="w-full max-w-md sm:max-w-full animate-fadeIn">
      <GameOptions client:load />
    </div>
  </main>
</Layout>

<style>
  /* 页面加载动画 - 渐入效果 */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fadeIn {
    animation: fadeIn 0.5s ease-out forwards;
  }

  /* 欢迎提示动画 - 脉冲效果 */
  @keyframes pulse {
    0%, 100% {
      opacity: 0.7;
    }
    50% {
      opacity: 1;
    }
  }
  .animate-pulse {
    animation: pulse 2s ease-in-out infinite;
  }

  /* 欢迎提示消失动画 */
  @keyframes fadeOut {
    from {
      opacity: 1;
      transform: translateY(0);
    }
    to {
      opacity: 0;
      transform: translateY(-20px);
    }
  }
  .animate-fadeOut {
    animation: fadeOut 0.5s ease-out forwards;
  }
</style>

<script>
  // 页面加载完成后处理欢迎提示的消失动画，并检查 GameOptions 是否加载成功
  document.addEventListener('DOMContentLoaded', () => {
    const welcomePrompt = document.getElementById('welcomePrompt');
    const loadingError = document.getElementById('loadingError');
    const retryButton = document.getElementById('retryButton');

    if (welcomePrompt) {
      setTimeout(() => {
        welcomePrompt.classList.remove('animate-pulse');
        welcomePrompt.classList.add('animate-fadeOut');
        setTimeout(() => {
          welcomePrompt.classList.add('hidden');
        }, 500); // 消失动画完成后隐藏
      }, 3000); // 3秒后开始消失动画
    }

    // 简单的错误处理逻辑 - 检测 GameOptions 是否加载失败
    setTimeout(() => {
      const gameOptions = document.querySelector('[data-astro-component="GameOptions"]');
      if (!gameOptions && loadingError) {
        loadingError.classList.remove('hidden');
      }
    }, 5000); // 5秒后检查是否加载失败

    // 重试按钮逻辑 - 刷新页面
    if (retryButton) {
      retryButton.addEventListener('click', () => {
        window.location.reload();
      });
    }
  });
</script>